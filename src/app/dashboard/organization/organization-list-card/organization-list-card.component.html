<ng-container *ngIf="animation$ | async as animation">
  <mat-card [ngClass]="{'background-content-card-active': !organization.deleted_at, 'background-content-card-inactive': organization.deleted_at,
    'text-muted': organization.deleted_at}">
    <mat-card-header class="d-flex justify-content-between">
      <mat-card-title>
        <h5 class="title" [matTooltip]="organization.name" matTooltipPosition="right">
          <span *ngIf="organization.created_by === user._id" class="mr-2 icon">
            <mat-icon color="warn">star</mat-icon>
          </span>
          <span *ngIf="organization.created_by !== user._id" class="mr-2 icon">
            <mat-icon color="primary">account_circle</mat-icon>
          </span>
          {{organization.name}}
        </h5>
      </mat-card-title>

      <div class="d-flex justify-content-end">

        <button class="button" mat-icon-button matTooltip="Ingresar a la organización" matTooltipPosition="above"
          (click)="selectOrganization(organization)">
          <mat-icon>meeting_room</mat-icon>
        </button>

        <button class="button" *ngIf="organization.created_by === user._id" mat-icon-button [matMenuTriggerFor]="menu"
          aria-label="Acciones" matTooltip="Acciones" matTooltipPosition="above">
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu">
          <ng-container>
            <button *ngIf="!organization.deleted_at" mat-menu-item (click)="updateOrganization(organization)">
              <mat-icon>create</mat-icon>
              <span>Editar nombre</span>
            </button>
            <button *ngIf="!organization.deleted_at" mat-menu-item (click)="deleteOrganization(organization)">
              <mat-icon>delete</mat-icon>
              <span>Dar de baja</span>
            </button>
            <button *ngIf="organization.deleted_at" mat-menu-item (click)="reactivateOrganization(organization)">
              <mat-icon>history</mat-icon>
              <span>Restaurar</span>
            </button>
          </ng-container>
        </mat-menu>
      </div>

    </mat-card-header>
    <mat-divider></mat-divider>

    <mat-card-content class="d-flex align-items-center">
      <span class="organization-card-info d-flex align-items-center">
        <mat-icon class="icon">bookmarks</mat-icon>
        Áreas / <mat-spinner *ngIf="areasLoading" class="ml-2 animated" diameter="15" [ngClass]="animation[3]"></mat-spinner> <span *ngIf="!areasLoading"
          class="ml-1 animated delay-300ms" [ngClass]="animation[3]">{{areas.length}}</span>
      </span>
      <span class="organization-card-info d-flex align-items-center">
        <mat-icon class="icon">supervised_user_circle</mat-icon>
        Miembros / <mat-spinner *ngIf="membersLoading" class="ml-2 animated" diameter="15" [ngClass]="animation[3]"></mat-spinner> <span
          *ngIf="!membersLoading" class="ml-1 animated delay-300ms" [ngClass]="animation[3]">{{members.length}}</span>
      </span>

      <span class=" organization-card-info d-flex align-items-center">
        <mat-icon class="icon">watch_later</mat-icon>
        Creada el /
        <span class="success ml-1">
          {{organization.created_at | date:'dd-MM-yyyy'}}
        </span>
      </span>
      <span class="organization-card-info d-flex align-items-center" *ngIf="organization.deleted_at">
        <mat-icon class="icon">delete</mat-icon> Dada de baja el /
        <span class="danger ml-1">
          {{organization.deleted_at | date:'dd-MM-yyyy'}}
        </span>
      </span>
    </mat-card-content>
  </mat-card>
</ng-container>